version: 2

models:

  - name: base__shopify__customer
    description: Each record represents a customer in Shopify.
    columns:
      - name: id
        description: PK of the table, which is the combination of customer_id & source_relation.
        tests: 
          - not_null
          - unique
      - name: customer_id
        description: A unique identifier for the customer.
        tests: 
          - not_null
      - name: _fivetran_synced
        description: "{{ doc('_fivetran_synced') }}"
      - name: marketing_consent_state
        description: >
          Field indicating if the customer has consented to receive marketing material via email. Coalescing of the new `email_marketing_consent_state`
          field and the deprecated `accepts_marketing` field. Records with the old field will be marked with '(legacy)'.
      - name: marketing_opt_in_level
        description: The marketing subscription opt-in level, as described in the M3AAWG Sender Best Common Practices, that the customer gave when they consented to receive marketing material by email.
      - name: marketing_consent_updated_at
        description: The date and time when the customer consented to receive marketing material by email. If no date is provided, then the date and time when the consent information was sent is used.
      - name: created_timestamp
        description: The date and time when the customer was created.
      - name: default_address_id
        description: The default address for the customer.
      - name: email
        description: The unique email address of the customer. Attempting to assign the same email address to multiple customers returns an error.
      - name: first_name
        description: The customer's first name.
      - name: last_name
        description: The customer's last name.
      - name: orders_count
        description: The number of orders associated with this customer.
      - name: phone
        description: The unique phone number (E.164 format) for this customer. Attempting to assign the same phone number to multiple customers returns an error.
      - name: account_state
        description: The state of the customer's account with a shop.
      - name: is_tax_exempt
        description: Whether the customer is exempt from paying taxes on their order. If true, then taxes won't be applied to an order at checkout. If false, then taxes will be applied at checkout.
      - name: total_spent
        description: The total amount of money that the customer has spent across their order history.
      - name: updated_timestamp
        description: The date and time when the customer information was last updated.
      - name: is_verified_email
        description: Whether the customer has verified their email address.
      - name: lifetime_duration
        description: The amount of time since the customer was first added to the store.
      - name: currency 
        description: The three-letter code (ISO 4217 format) for the currency that the customer used when they paid for their last order. Defaults to the shop currency. Returns the shop currency for test orders.
      - name: source_relation
        description: "{{ doc('shopify_source_relation') }}"
      - name: note
        description: A note about the customer.


  - name: base__shopify__abandoned_checkout
    description: A checkout is considered abandoned after the customer has added contact information, but before the customer has completed their purchase.
    columns:
      - name: id
        description: PK of the table, which is the combination of checkout_id & source_relation.
        tests: 
          - not_null
          - unique
      - name: checkout_id
        description: The ID for the checkout.
        tests:
          - not_null
      - name: is_deleted
        description: "{{ doc('_fivetran_deleted') }}"
      - name: _fivetran_synced
        description: "{{ doc('_fivetran_synced') }}"
      - name: abandoned_checkout_url
        description: The recovery URL that's sent to a customer so they can recover their checkout.
      - name: billing_address_address_1
        description: The street address of the billing address.
      - name: billing_address_address_2
        description: An optional additional field for the street address of the billing address.
      - name: billing_address_city
        description: The city of the billing address.
      - name: billing_address_company
        description: The company of the person associated with the billing address.
      - name: billing_address_country
        description: The name of the country of the billing address.
      - name: billing_address_country_code
        description: The two-letter code (ISO 3166-1 alpha-2 format) for the country of the billing address.
      - name: billing_address_first_name
        description: The first name of the person associated with the payment method.
      - name: billing_address_last_name
        description: The last name of the person associated with the payment method.
      - name: billing_address_latitude
        description: The latitude of the billing address.
      - name: billing_address_longitude
        description: The longitude of the billing address.
      - name: billing_address_name
        description: The full name of the person associated with the payment method.
      - name: billing_address_phone
        description: The phone number at the billing address.
      - name: billing_address_province
        description: The name of the state or province of the billing address.
      - name: billing_address_province_code
        description: The two-letter abbreviation of the state or province of the billing address.
      - name: billing_address_zip
        description: The zip or postal code of the billing address.
      - name: has_buyer_accepted_marketing
        description: Whether the customer would like to receive email updates from the shop. This is set by the 'I want to receive occasional emails about new products, promotions and other news' checkbox during checkout.
      - name: cart_token
        description: The ID for the cart that's attached to the checkout.
      - name: closed_at
        description: The date and time (ISO 8601 format) when the checkout was closed. If the checkout was not closed, then this value is null.
      - name: created_at
        description: The date and time (ISO 8601 format) when the checkout was created.
      - name: shop_currency
        description: The three-letter code (ISO 4217 format) of the shop's default currency at the time of checkout. For the currency that the customer used at checkout, see `presentment_currency`.
      - name: customer_id
        description: ID of the customer with the abandoned checkout.
      - name: customer_locale
        description: The two or three-letter language code, optionally followed by a region modifier. Example values - en, en-CA.
      - name: device_id
        description: The ID of the Shopify POS device that created the checkout.
      - name: email
        description: The customer's email address.
      - name: gateway
        description: The payment gateway used by the checkout.
      - name: landing_site_base_url
        description: The URL for the page where the customer entered the shop.
      - name: location_id
        description: The ID of the physical location where the checkout was processed.
      - name: name
        description: Checkout order number. 
      - name: note
        description: The text of an optional note that a shop owner can attach to the order.
      - name: phone
        description: The customer's phone number for receiving SMS notifications.
      - name: presentment_currency
        description: The three-letter code (ISO 4217 format) of the currency that the customer used at checkout. For the shop's default currency, see `currency`.
      - name: referring_site
        description: The website that referred the customer to the shop.
      - name: shipping_address_address_1
        description: The street address of the shipping address.
      - name: shipping_address_address_2
        description: An optional additional field for the street address of the shipping address.
      - name: shipping_address_city
        description: The city of the shipping address.
      - name: shipping_address_company
        description: The company of the person associated with the shipping address.
      - name: shipping_address_country
        description: The name of the country of the shipping address.
      - name: shipping_address_country_code
        description: The two-letter code (ISO 3166-1 alpha-2 format) for the country of the shipping address.
      - name: shipping_address_first_name
        description: The first name of the person associated with the shipping address.
      - name: shipping_address_last_name
        description: The last name of the person associated with the shipping address.
      - name: shipping_address_latitude
        description: The latitude of the shipping address.
      - name: shipping_address_longitude
        description: The longitude of the shipping address.
      - name: shipping_address_name
        description: The full name of the person associated with the shipping address.
      - name: shipping_address_phone
        description: The phone number at the shipping address.
      - name: shipping_address_province
        description: The name of the state or province of the shipping address.
      - name: shipping_address_province_code
        description: The two-letter abbreviation of the state or province of the shipping address.
      - name: shipping_address_zip
        description: The zip or postal code of the shipping address.
      - name: source_name
        description: Where the checkout originated. Valid values include `web`, `pos`, `iphone`, `android`.
      - name: subtotal_price
        description: The price of the checkout in _presentment_ (customer) currency before shipping and taxes.
      - name: has_taxes_included
        description: Boolean representing whether taxes are included in the price.
      - name: token
        description: A unique ID for a checkout.
      - name: total_discounts
        description: The total amount of discounts to be applied in presentment currency.
      - name: total_duties
        description: The total duties of the checkout in presentment currency.
      - name: total_line_items_price
        description: The sum of the prices of all line items in the checkout in _presentment_ (customer) currency.
      - name: total_price
        description: The sum of line item prices, all discounts, shipping costs, and taxes for the checkout in _presentment_ (customer) currency.
      - name: total_tax
        description: The sum of all the taxes applied to the checkout in _presentment_ (customer) currency.
      - name: total_weight
        description: The sum of all the weights in grams of the line items in the checkout.
      - name: updated_at
        description: The date and time (ISO 8601 format) when the checkout was last modified.
      - name: user_id
        description: The ID of the user who created the checkout.
      - name: source_relation
        description: "{{ doc('shopify_source_relation') }}"