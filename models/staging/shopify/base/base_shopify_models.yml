version: 2

models:

  - name: base__shopify__orders
    description: Each record represents an order in Shopify.
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - order_id
            - source_relation
    columns:
      - name: order_id
        description: The ID of the order, used for API purposes. This is different from the order_number property, which is the ID used by the shop owner and customer.
        tests: 
          - not_null
      - name: _fivetran_synced
        description: "{{ doc('_fivetran_synced') }}"
      - name: app_id
        description: The ID of the app that created the order.
      - name: checkout_id
        description: ID of the order's checkout. 
      - name: order_status_url
        description: The URL pointing to the order status web page, if applicable.
      - name: billing_address_address_1
        description: The street address of the billing address.
      - name: billing_address_address_2
        description: An optional additional field for the street address of the billing address.
      - name: billing_address_city
        description: The city, town, or village of the billing address.
      - name: billing_address_company
        description: The company of the person associated with the billing address.
      - name: billing_address_country
        description: The name of the country of the billing address.
      - name: billing_address_country_code
        description: The two-letter code (ISO 3166-1 format) for the country of the billing address.
      - name: billing_address_first_name
        description: The first name of the person associated with the payment method.
      - name: billing_address_last_name
        description: The last name of the person associated with the payment method.
      - name: billing_address_latitude
        description: The latitude of the billing address.
      - name: billing_address_longitude
        description: The longitude of the billing address.
      - name: billing_address_name
        description: The full name of the person associated with the payment method.
      - name: billing_address_phone
        description: The phone number at the billing address.
      - name: billing_address_province
        description: The name of the region (province, state, prefecture, …) of the billing address.
      - name: billing_address_province_code
        description: The two-letter abbreviation of the region of the billing address.
      - name: billing_address_zip
        description: The postal code (zip, postcode, Eircode, …) of the billing address.
      - name: browser_ip
        description: The IP address of the browser used by the customer when they placed the order.
      - name: has_buyer_accepted_marketing
        description: Whether the customer consented to receive email updates from the shop.
      - name: cancel_reason
        description: The reason why the order was canceled.
      - name: cancelled_timestamp
        description: The date and time when the order was canceled.
      - name: cart_token
        description: The ID of the cart that's associated with the order.
      - name: closed_timestamp
        description: The date and time when the order was closed (archived).
      - name: created_timestamp
        description: The autogenerated date and time when the order was created in Shopify.
      - name: currency
        description: The three-letter code for the shop currency.
      - name: customer_id
        description: The ID of the order's customer.
      - name: email
        description: The customer's email address.
      - name: financial_status
        description: The status of payments associated with the order. Can only be set when the order is created
      - name: fulfillment_status
        description: The order's status in terms of fulfilled line items.
      - name: landing_site_base_url
        description: The URL for the page where the buyer landed when they entered the shop.
      - name: location_id
        description: The ID of the physical location where the order was processed.
      - name: order_name
        description: The order name, generated by combining the order_number property with the order prefix and suffix that are set in the merchant's general settings.
      - name: note
        description: An optional note that a shop owner can attach to the order.
      - name: shop_order_number
        description: The order's position in the shop's count of orders. Numbers are sequential and start at 1.
      - name: order_number
        description: The order 's position in the shop's count of orders starting at 1001. Order numbers are sequential and start at 1001.
      - name: processed_timestamp
        description: The date and time when an order was processed. This value is the date that appears on your orders and that's used in the analytic reports.
      - name: processing_method
        description: How the payment was processed.
      - name: referring_site
        description: The website where the customer clicked a link to the shop.
      - name: shipping_address_address_1
        description: The street address of the shipping address.
      - name: shipping_address_address_2
        description: An optional additional field for the street address of the shipping address.
      - name: shipping_address_city
        description: The city, town, or village of the shipping address.
      - name: shipping_address_company
        description: The company of the person associated with the shipping address.
      - name: shipping_address_country
        description: The name of the country of the shipping address.
      - name: shipping_address_country_code
        description: The two-letter code (ISO 3166-1 format) for the country of the shipping address.
      - name: shipping_address_first_name
        description: The first name of the person associated with the shipping address.
      - name: shipping_address_last_name
        description: The last name of the person associated with the shipping address.
      - name: shipping_address_latitude
        description: The latitude of the shipping address.
      - name: shipping_address_longitude
        description: The longitude of the shipping address.
      - name: shipping_address_name
        description: The full name of the person associated with the payment method.
      - name: shipping_address_phone
        description: The phone number at the shipping address.
      - name: shipping_address_province
        description: The name of the region (province, state, prefecture, …) of the shipping address.
      - name: shipping_address_province_code
        description: The two-letter abbreviation of the region of the shipping address.
      - name: shipping_address_zip
        description: The postal code (zip, postcode, Eircode, …) of the shipping address.
      - name: source_name
        description: Where the order originated. Can be set only during order creation, and is not writeable afterwards.
      - name: subtotal_price
        description: The price of the order in the shop currency after discounts but before shipping, taxes, and tips.
      - name: has_taxes_included
        description: Whether taxes are included in the order subtotal.
      - name: is_test_order
        description: Whether this is a test order.
      - name: token
        description: A unique token for the order.
      - name: total_discounts
        description: The total discounts applied to the price of the order in the shop currency.
      - name: total_line_items_price
        description: The sum of all line item prices in the shop currency.
      - name: total_price
        description: The sum of all line item prices, discounts, shipping, taxes, and tips in the shop currency. Must be positive.
      - name: total_tax
        description: The sum of all the taxes applied to the order in th shop currency. Must be positive).
      - name: total_weight
        description: The sum of all line item weights in grams.
      - name: updated_timestamp
        description: The date and time (ISO 8601 format) when the order was last modified.
      - name: user_id
        description: The ID of the user logged into Shopify POS who processed the order, if applicable.
      - name: total_shipping_price_set
        description: The total shipping price set for the order in presentment and shop currencies.
      - name: checkout_token
        description: A unique value when referencing the checkout that's associated with the order.
      - name: customer_locale 
        description: A two-letter or three-letter language code, optionally followed by a region modifier.
      - name: is_deleted
        description: "{{ doc('_fivetran_deleted') }}"
      - name: total_tip_received
        description: The sum of all the tips in the order in the shop currency.
      - name: client_details_user_agent
        description: Details of the browsing client, including software and operating versions.
      - name: total_tax_set
        description: The total tax applied to the order in shop and presentment currencies.
      - name: total_shipping_price_set
        description: The total shipping price of the order, excluding discounts and returns, in shop and presentment currencies. If taxes_included is set to true, then total_shipping_price_set includes taxes.
      - name: total_discounts_set
        description: The total discounts applied to the price of the order in shop and presentment currencies.
      - name: presentment_currency
        description: The presentment currency that was used to display prices to the customer.
      - name: source_relation
        description: "{{ doc('shopify_source_relation') }}"
      - name: total_line_items_price_set
        description: The total of all line item prices in shop and presentment currencies.
      - name: total_price_set
        description: The total price of the order in shop and presentment currencies.
      - name: total_price_usd
        description: The sum of all line item prices, discounts, shipping, taxes, and tips in USD. Must be positive.
      - name: is_confirmed
        description: Whether the order is confirmed.
      - name: current_total_price
        description: The current total price of the order in the shop currency. The value of this field reflects order edits, returns, and refunds.
      - name: source_identifier
        description: The ID of the order placed on the originating platform. This value doesn't correspond to the Shopify ID that's generated from a completed draft.

  - name: base__shopify__order_line_refund
    description: Each record represents a line item from an order in Shopify.
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - order_line_refund_id
            - source_relation
    columns:
      - name: _fivetran_synced
        description: "{{ doc('_fivetran_synced') }}"
      - name: order_line_refund_id
        description: The unique identifier of the line item in the refund.
        tests: 
          - not_null
      - name: location_id
        description: TThe unique identifier of the location where the items will be restockedBD
      - name: order_line_id
        description: The ID of the related line item in the order.
      - name: quantity
        description: The quantity of the associated line item that was returned.
      - name: refund_id
        description: The ID of the related refund.
      - name: restock_type
        description: How this refund line item affects inventory levels.
      - name: subtotal
        description: Subtotal amount of the order line refund in shop currency.
      - name: total_tax
        description: The total tax applied to the refund in the shop currency.
      - name: source_relation
        description: "{{ doc('shopify_source_relation') }}"
      - name: subtotal_set 
        description: The subtotal of the refund line item in shop and presentment currencies.
      - name: total_tax_set 
        description: The total tax of the line item in shop and presentment currencies.

  - name: base__shopify__order_line
    description: Each record represents a line item from an order in Shopify.
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - order_line_id
            - source_relation
    columns:
      - name: _fivetran_synced
        description: "{{ doc('_fivetran_synced') }}"
      - name: fulfillable_quantity
        description: "The amount available to fulfill, calculated as follows: quantity - max(refunded_quantity, fulfilled_quantity) - pending_fulfilled_quantity - open_fulfilled_quantity"
      - name: fulfillment_service
        description: The service provider that's fulfilling the item.
      - name: fulfillment_status
        description: How far along an order is in terms line items fulfilled.
      - name: is_gift_card
        description: Whether the item is a gift card. If true, then the item is not taxed or considered for shipping charges.
      - name: grams
        description: The weight of the item in grams.
      - name: order_line_id
        description: The ID of the line item.
        tests: 
          - not_null
      - name: name
        description: The name of the product variant.
      - name: order_id
        description: The ID of the related order.
      - name: price
        description: The price of the item before discounts have been applied in the shop currency.
      - name: product_id
        description: The ID of the product that the line item belongs to. Can be null if the original product associated with the order is deleted at a later date.
      - name: quantity
        description: The number of items that were purchased.
      - name: is_shipping_required
        description: Whether the item requires shipping.
      - name: sku
        description: The item's SKU (stock keeping unit).
      - name: is_taxable
        description: Whether the item was taxable.
      - name: title
        description: The title of the product.
      - name: total_discount
        description: The total amount of the discount allocated to the line item in the shop currency.
      - name: variant_id
        description: The ID of the product variant.
      - name: vendor
        description: The name of the item's supplier.
      - name: source_relation
        description: "{{ doc('shopify_source_relation') }}"
      - name: index
        description: Index of the order line.
      - name: pre_tax_price
        description: The pre tax price of the line item in shop currency.
      - name: pre_tax_price_set
        description: The pre tax price of the line item in shop currency and presentment currency.
      - name: price_set
        description: The price of the line item in shop and presentment currencies.
      - name: tax_code
        description: Tax code applied to the line item. As multiple taxes can apply to a line item, we recommend referring to `stg_shopify__tax_line`.
      - name: total_discount_set
        description: The total amount allocated to the line item in the presentment currency.
      - name: variant_title
        description: The title of the product variant.
      - name: variant_inventory_management
        description: The fulfillment service that tracks the number of items in stock for the product variant.
      - name: properties
        description: Line item properties.
      - name: destination_location_address_1
        description: The street address of the assigned location.
      - name: destination_location_address_2
        description: An optional additional field for the street address of the assigned location.
      - name: destination_location_city
        description: City of the destination where the items should be sent.
      - name: destination_location_country_code
        description: Two-letter country code (ISO 3166-1 format) of the destination where the items should be sent.
      - name: destination_location_id
        description: ID of the destination where the items should be sent.
      - name: destination_location_name
        description: Name of the destination where the items should be sent.
      - name: destination_location_province_code
        description: Two-letter province code of the destination where the items should be sent.
      - name: destination_location_zip
        description: Zip code of the destination where the items should be sent.
      - name: origin_location_address_1
        description: The street address of the item's supplier.
      - name: origin_location_address_2
        description: The suite number of the item's supplier.
      - name: origin_location_city
        description: The city of the item's supplier.
      - name: origin_location_country_code
        description: The two-letter code (ISO 3166-1 format) for the country of the item's supplier.
      - name: origin_location_id
        description: The location ID of the line item’s fulfillment origin. Used by Shopify to calculate applicable taxes. This is not the ID of the location where the order was placed. You can use the FulfillmentOrder resource to determine the location an item will be sourced from.
      - name: origin_location_name
        description: The name of the item's supplier.
      - name: origin_location_province_code
        description: The two-letter abbreviation for the region of the item's supplier.
      - name: origin_location_zip
        description: The zip of the item's supplier.
  
  - name: base__shopify__refund
    description: Each record represents a refund within Shopify.
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - refund_id
            - source_relation
    columns:
      - name: refund_id
        description: The unique numeric identifier for the refund.
        tests:
          - not_null
      - name: created_at
        description: Timestamp of the date when the refund was created.
      - name: processed_at
        description: Timestamp of the date when the refund was processed.
      - name: note
        description: User generated note attached to the refund.
      - name: restock
        description: Boolean indicating if the refund is a result of a restock.
      - name: user_id
        description: Reference to the user id which generated the refund.
      - name: _fivetran_synced
        description: "{{ doc('_fivetran_synced') }}"
      - name: total_duties_set
        description: Record representing total duties set for the refund.
      - name: order_id
        description: Reference to the order which the refund is associated.
      - name: source_relation
        description: "{{ doc('shopify_source_relation') }}"

  - name: base__shopify__order_adjustment
    description: Each record represents and adjustment to and order within Shopify.
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - order_adjustment_id
            - source_relation
    columns:
      - name: order_adjustment_id
        description: The unique numeric identifier for the order adjustment.
        tests: 
          - not_null
      - name: order_id
        description: Reference to the order which the adjustment is associated.
      - name: refund_id
        description: Reference to the refund which the adjustment is associated.
      - name: amount
        description: Amount of the adjustment.
      - name: tax_amount
        description: Tax amount applied to the order adjustment in the shop currency.
      - name: kind
        description: The kind of order adjustment (eg. refund, restock, etc.).
      - name: reason
        description: The reason for the order adjustment.
      - name: amount_set
        description: Amount set towards the order adjustment in presentment and shop currencies.
      - name: tax_amount_set
        description: Tax amount set towards the order adjustment in the shop and presentment currencies.
      - name: _fivetran_synced
        description: "{{ doc('_fivetran_synced') }}"
      - name: source_relation
        description: "{{ doc('shopify_source_relation') }}"
