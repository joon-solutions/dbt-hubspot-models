version: 2

sources:
  # - name: shopify_us
  #   schema: shopify_us
  #   database: joon_solutions
  #   tables:
  #     - name: customer
  #       description: Each record represents a customer in Shopify.

  # - name: shopify_mx
  #   schema: shopify_mx
  #   database: joon_solutions
  #   tables:
  #     - name: customer
  #       description: Each record represents a customer in Shopify.

  - name: shopify
    schema: shopify
    database: joon_solutions
    tables:
      - name: orders
      - name: refund
      - name: order_line
      - name: order_line_refund
      - name: order_adjustment
      - name: inventory_level
      - name: inventory_level_user_input # optional source
      - name: customer
        description: Each record represents a customer in Shopify.
        columns:
          - name: _fivetran_synced
            description: "{{ doc('_fivetran_synced') }}"
          - name: accepts_marketing
            description: Whether the customer has consented to receive marketing material via email. Deprecated and will be coalesced with `email_marketing_consent_state`.
          - name: created_at
            description: The date and time when the customer was created.
          - name: default_address_id
            description: The default address for the customer.
          - name: email
            description: The unique email address of the customer. Attempting to assign the same email address to multiple customers returns an error.
          - name: first_name
            description: The customer's first name.
          - name: id
            description: A unique identifier for the customer.
          - name: last_name
            description: The customer's last name.
          - name: orders_count
            description: The number of orders associated with this customer.
          - name: phone
            description: The unique phone number (E.164 format) for this customer. Attempting to assign the same phone number to multiple customers returns an error.
          - name: state
            description: The state of the customer's account with a shop.
          - name: tax_exempt
            description: Whether the customer is exempt from paying taxes on their order. If true, then taxes won't be applied to an order at checkout. If false, then taxes will be applied at checkout.
          - name: total_spent
            description: The total amount of money that the customer has spent across their order history.
          - name: updated_at
            description: The date and time when the customer information was last updated.
          - name: verified_email
            description: Whether the customer has verified their email address.
          - name: email_marketing_consent_state
            description: The current email marketing state for the customer. New version of `accepts_marketing` field.
          - name: email_marketing_consent_opt_in_level
            description: The marketing subscription opt-in level, as described in the M3AAWG Sender Best Common Practices, that the customer gave when they consented to receive marketing material by email. New version of `marketing_opt_in_level` field.
          - name: email_marketing_consent_consent_updated_at
            description: The date and time when the customer consented to receive marketing material by email. If no date is provided, then the date and time when the consent information was sent is used. New version of `accepts_marketing_updated_at` field.
          - name: accepts_marketing_updated_at
            description: Deprecated. The package will coalesce with `email_marketing_consent_consent_updated_at`. 
          - name: marketing_opt_in_level
            description: Deprecated. The package will coalesce with `email_marketing_consent_opt_in_level`.
          - name: lifetime_duration
            description: The amount of time since the customer was first added to the store.
          - name: _fivetran_deleted
            description: "{{ doc('_fivetran_deleted') }}"
          - name: note
            description: A note about the customer.
          - name: currency 
            description: The three-letter code (ISO 4217 format) for the currency that the customer used when they paid for their last order. Defaults to the shop currency. Returns the shop currency for test orders.

      # - name: abandoned_checkout_discount_code
      #   description: Abandoned checkouts that applied a discount code. 
      #   identifier: "{{ var('shopify_abandoned_checkout_discount_code_identifier', 'abandoned_checkout_discount_code') }}"
      #   columns:
      #     - name: _fivetran_synced
      #       description: "{{ doc('_fivetran_synced') }}"
      #     - name: amount
      #       description: The amount of the discount in presentment currency.
      #     - name: checkout_id
      #       description: ID of the checkout. 
      #     - name: code
      #       description: The discount code.
      #     - name: created_at
      #       description: When the checkout discount application was created.
      #     - name: discount_id
      #       description: ID of the discount. Deprecated, use `code` instead.
      #     - name: index
      #       description: Index (from 1) representing the application of the discount to the checkout. Use the latest (highest index)
      #     - name: type
      #       description: The type of discount. Valid values - percentage, shipping, fixed_amount. (default - fixed_amount)
      #     - name: updated_at
      #       description: When the checkout's discount was last updated

      - name: abandoned_checkout
        description: A checkout is considered abandoned after the customer has added contact information, but before the customer has completed their purchase.
        columns:
          - name: _fivetran_deleted
            description: "{{ doc('_fivetran_deleted') }}"
          - name: _fivetran_synced
            description: "{{ doc('_fivetran_synced') }}"
          - name: abandoned_checkout_url
            description: The recovery URL that's sent to a customer so they can recover their checkout.
          - name: billing_address_address_1
            description: The street address of the billing address.
          - name: billing_address_address_2
            description: An optional additional field for the street address of the billing address.
          - name: billing_address_city
            description: The city of the billing address.
          - name: billing_address_company
            description: The company of the person associated with the billing address.
          - name: billing_address_country
            description: The name of the country of the billing address.
          - name: billing_address_country_code
            description: The two-letter code (ISO 3166-1 alpha-2 format) for the country of the billing address.
          - name: billing_address_first_name
            description: The first name of the person associated with the payment method.
          - name: billing_address_last_name
            description: The last name of the person associated with the payment method.
          - name: billing_address_latitude
            description: The latitude of the billing address.
          - name: billing_address_longitude
            description: The longitude of the billing address.
          - name: billing_address_name
            description: The full name of the person associated with the payment method.
          - name: billing_address_phone
            description: The phone number at the billing address.
          - name: billing_address_province
            description: The name of the state or province of the billing address.
          - name: billing_address_province_code
            description: The two-letter abbreviation of the state or province of the billing address.
          - name: billing_address_zip
            description: The zip or postal code of the billing address.
          - name: buyer_accepts_marketing
            description: Whether the customer would like to receive email updates from the shop. This is set by the 'I want to receive occasional emails about new products, promotions and other news' checkbox during checkout.
          - name: cart_token
            description: The ID for the cart that's attached to the checkout.
          - name: closed_at
            description: The date and time (ISO 8601 format) when the checkout was closed. If the checkout was not closed, then this value is null.
          - name: created_at
            description: The date and time (ISO 8601 format) when the checkout was created.
          - name: currency
            description: The three-letter code (ISO 4217 format) of the shop's default currency at the time of checkout. For the currency that the customer used at checkout, see `presentment_currency`.
          - name: customer_id
            description: ID of the customer with the abandoned checkout.
          - name: customer_locale
            description: The two or three-letter language code, optionally followed by a region modifier. Example values - en, en-CA.
          - name: device_id
            description: The ID of the Shopify POS device that created the checkout.
          - name: email
            description: The customer's email address.
          - name: gateway
            description: The payment gateway used by the checkout.
          - name: id
            description: The ID for the checkout.
          - name: landing_site_base_url
            description: The URL for the page where the customer entered the shop.
          - name: location_id
            description: The ID of the physical location where the checkout was processed.
          - name: name
            description: Checkout order number. 
          - name: note
            description: The text of an optional note that a shop owner can attach to the order.
          - name: phone
            description: The customer's phone number for receiving SMS notifications.
          - name: presentment_currency
            description: The three-letter code (ISO 4217 format) of the currency that the customer used at checkout. For the shop's default currency, see `currency`.
          - name: referring_site
            description: The website that referred the customer to the shop.
          - name: shipping_address_address_1
            description: The street address of the shipping address.
          - name: shipping_address_address_2
            description: An optional additional field for the street address of the shipping address.
          - name: shipping_address_city
            description: The city of the shipping address.
          - name: shipping_address_company
            description: The company of the person associated with the shipping address.
          - name: shipping_address_country
            description: The name of the country of the shipping address.
          - name: shipping_address_country_code
            description: The two-letter code (ISO 3166-1 alpha-2 format) for the country of the shipping address.
          - name: shipping_address_first_name
            description: The first name of the person associated with the shipping address.
          - name: shipping_address_last_name
            description: The last name of the person associated with the shipping address.
          - name: shipping_address_latitude
            description: The latitude of the shipping address.
          - name: shipping_address_longitude
            description: The longitude of the shipping address.
          - name: shipping_address_name
            description: The full name of the person associated with the shipping address.
          - name: shipping_address_phone
            description: The phone number at the shipping address.
          - name: shipping_address_province
            description: The name of the state or province of the shipping address.
          - name: shipping_address_province_code
            description: The two-letter abbreviation of the state or province of the shipping address.
          - name: shipping_address_zip
            description: The zip or postal code of the shipping address.
          - name: source_name
            description: Where the checkout originated. Valid values include `web`, `pos`, `iphone`, `android`.
          - name: subtotal_price
            description: The price of the checkout in _presentment_ (customer) currency before shipping and taxes.
          - name: taxes_included
            description: Boolean representing whether taxes are included in the price.
          - name: token
            description: A unique ID for a checkout.
          - name: total_discounts
            description: The total amount of discounts to be applied in presentment currency.
          - name: total_duties
            description: The total duties of the checkout in presentment currency.
          - name: total_line_items_price
            description: The sum of the prices of all line items in the checkout in _presentment_ (customer) currency.
          - name: total_price
            description: The sum of line item prices, all discounts, shipping costs, and taxes for the checkout in _presentment_ (customer) currency.
          - name: total_tax
            description: The sum of all the taxes applied to the checkout in _presentment_ (customer) currency.
          - name: total_weight
            description: The sum of all the weights in grams of the line items in the checkout.
          - name: updated_at
            description: The date and time (ISO 8601 format) when the checkout was last modified.
          - name: user_id
            description: The ID of the user who created the checkout.

      - name: tax_line
        description: Represents a single tax applied to the associated line item.
        columns:
          - name: _fivetran_synced
            description: "{{ doc('_fivetran_synced') }}"
          - name: index
            description: The index of the tax line.
          - name: order_line_id
            description: The order line that this tax line is associated with. 
          - name: price
            description: The amount of tax, in shop currency, after discounts and before returns. 
          - name: price_set
            description: The amount of tax, in shop and presentment currencies, after discounts and before returns.
          - name: rate
            description: The proportion of the line item price that the tax represents as a decimal.
          - name: title
            description: The name of the tax.

      - name: order_shipping_line
        description: Represents the shipping details that the customer chose for their order.
        columns:
          - name: _fivetran_synced
            description: "{{ doc('_fivetran_synced') }}"
          - name: carrier_identifier
            description: A reference to the carrier service that provided the rate. Present when the rate was computed by a third-party carrier service.
          - name: code
            description: A reference to the shipping method.
          - name: delivery_category
            description: The general classification of the delivery method.
          - name: discounted_price
            description: The pre-tax shipping price with discounts applied in the shop currency.
          - name: discounted_price_set
            description: The pre-tax shipping price with discounts applied (JSON) in presentment and shop currencies.
          - name: id
            description: A globally-unique identifier.
          - name: order_id
            description: ID of the associated order.
          - name: phone
            description: The phone number at the shipping address.
          - name: price
            description: Returns the price of the shipping line in shop currency.
          - name: price_set
            description: Returns the price of the shipping line (JSON) in presentment and shop currencies.
          - name: requested_fulfillment_service_id
            description: The fulfillment service requested for the shipping method. Present if the shipping method requires processing by a third party fulfillment service.
          - name: source
            description: Returns the rate source for the shipping line.
          - name: title
            description: Returns the title of the shipping line.

      - name: order_shipping_tax_line
        description: Represents taxes associated with order shipping lines.
        columns:
          - name: _fivetran_synced
            description: "{{ doc('_fivetran_synced') }}"
          - name: index
            description: Index (from 1) representing the order of shipping lines per order.
          - name: order_shipping_line_id
            description: ID of the order shipping line this recod is associated with.
          - name: price
            description: The amount of tax, in shop currency, after discounts and before returns.
          - name: price_set
            description: The amount of tax, in shop and presentment currencies, after discounts and before returns (JSON).
          - name: rate
            description: The proportion of the line item price that the tax represents as a decimal.
          - name: title
            description: The name of the tax.

      - name: tender_transaction
        description: >
          Each tender transaction represents money passing between the merchant and a customer. A tender transaction with a positive amount 
          represents a transaction where the customer paid money to the merchant. A negative amount represents a transaction where the 
          merchant refunded money back to the customer. Tender transactions represent transactions that modify the shop's balance.
        columns:
          - name: _fivetran_synced
            description: "{{ doc('_fivetran_synced') }}"
          - name: amount
            description: The amount of the tender transaction in the shop's currency.
          - name: currency
            description: The three-letter code (ISO 4217 format) for the currency used for the tender transaction.
          - name: id
            description: The ID of the transaction.
          - name: order_id
            description: The ID of the order that the tender transaction belongs to.
          - name: payment_method
            description: >
              Information about the payment method used for this transaction. Valid values include:
              - credit_card
              - cash
              - android_pay
              - apple_pay
              - google_pay
              - samsung_pay
              - shopify_pay
              - amazon
              - klarna
              - paypal
              - unknown
              - other
          - name: processed_at
            description: The date and time (ISO 8601 format) when the tender transaction was processed.
          - name: remote_reference
            description: The remote (gateway) reference associated with the tender.
          - name: test
            description: Whether the tender transaction is a test transaction.
          - name: user_id
            description: The ID of the user logged into the Shopify POS device that processed the tender transaction, if applicable.

      - name: transaction
        description: Each record represents a transaction in Shopify.
        columns:
          - name: id
            description: The ID for the transaction.
          - name: order_id
            description: The ID for the order that the transaction is associated with.
          - name: refund_id
            description: The ID associated with a refund in the refund table.
          - name: amount
            description: The amount of money included in the transaction.
          - name: authorization
            description: The authorization code associated with the transaction.
          - name: created_at
            description: The date and time when the transaction was created.
          - name: processed_at
            description: The date and time when a transaction was processed.
          - name: device_id
            description: The ID for the device.
          - name: gateway
            description: The name of the gateway the transaction was issued through.
          - name: source_name
            description: The origin of the transaction.
          - name: message
            description: A string generated by the payment provider with additional information about why the transaction succeeded or failed.
          - name: currency
            description: The three-letter code (ISO 4217 format) for the currency used for the payment.
          - name: location_id
            description: The ID of the physical location where the transaction was processed.
          - name: parent_id
            description: The ID of an associated transaction.
          - name: payment_avs_result_code
            description: The response code from the address verification system.
          - name: payment_credit_card_bin
            description: The issuer identification number (IIN), formerly known as bank identification number (BIN) of the customer's credit card.
          - name: payment_cvv_result_code
            description: The response code from the credit card company indicating whether the customer entered the card security code, or card verification value, correctly.
          - name: payment_credit_card_number
            description: The customer's credit card number, with most of the leading digits redacted.
          - name: payment_credit_card_company
            description: The name of the company that issued the customer's credit card.
          - name: kind
            description: The transaction's type.
          - name: receipt
            description: A transaction receipt attached to the transaction by the gateway.
          - name: currency_exchange_id
            description: The ID of the adjustment.
          - name: currency_exchange_adjustment
            description: The difference between the amounts on the associated transaction and the parent transaction.
          - name: currency_exchange_original_amount
            description: The amount of the parent transaction in the shop currency.
          - name: currency_exchange_final_amount
            description: The amount of the associated transaction in the shop currency.
          - name: currency_exchange_currency
            description: The shop currency.
          - name: error_code
            description: A standardized error code, independent of the payment provider.
          - name: status
            description: The status of the transaction.
          - name: test
            description: Whether the transaction is a test transaction.
          - name: user_id
            description: The ID for the user who was logged into the Shopify POS device when the order was processed, if applicable.
          - name: _fivetran_synced
            description: "{{ doc('_fivetran_synced') }}"
          - name: authorization_expires_at
            description: The date and time (ISO 8601 format) when the Shopify Payments authorization expires.

      - name: customer_tag
        description: Tags that the shop owner has attached to the customer. A customer can have up to 250 tags.
        columns:
          - name: _fivetran_synced
            description: "{{ doc('_fivetran_synced') }}"
          - name: index
            description: Index (starting from 1) represnting when the tag was placed on the customer. 
          - name: customer_id
            description: ID of the customer being tagged.
          - name: value
            description: Value of the tag.

      - name: order_tag
        description: Tags that the shop owner has attached to the order.
        columns:
          - name: _fivetran_synced
            description: "{{ doc('_fivetran_synced') }}"
          - name: index
            description: Index (starting from 1) represnting when the tag was placed on the order. 
          - name: order_id
            description: ID of the order being tagged.
          - name: value
            description: Value of the tag.

      - name: order_url_tag
        description: Key-value tags that the shop owner has attached to the order url.
        columns:
          - name: _fivetran_synced
            description: "{{ doc('_fivetran_synced') }}"
          - name: key
            description: Key of the tag pair.
          - name: order_id
            description: ID of the order url being tagged.
          - name: value
            description: Value of the tag.

      - name: fulfillment
        description: >
          A fulfillment order represents a group of one or more items in an order that will be fulfilled from the same location. 
          A fulfillment represents work that is completed as part of a fulfillment order and can include one or more items.
        columns:
          - name: _fivetran_synced
            description: "{{ doc('_fivetran_synced') }}"
          - name: created_at
            description: The date and time when the fulfillment was created. The API returns this value in ISO 8601 format.
          - name: id
            description: The ID for the fulfillment.
          - name: location_id
            description: The unique identifier of the location that the fulfillment was processed at.
          - name: name
            description: >
              The uniquely identifying fulfillment name, consisting of two parts separated by a .. The first part represents the order name and the second part represents the fulfillment number. 
              The fulfillment number automatically increments depending on how many fulfillments are in an order (e.g. #1001.1, #1001.2).
          - name: order_id
            description: The unique numeric identifier for the order.
          - name: receipt_authorization
            description: The authorization code from the receipt.
          - name: service
            description: The fulfillment service associated with the fulfillment.
          - name: shipment_status
            description: >
              The current shipment status of the fulfillment. Valid values include:
              - label_printed: A label for the shipment was purchased and printed.
              - label_purchased: A label for the shipment was purchased, but not printed.
              - attempted_delivery: Delivery of the shipment was attempted, but unable to be completed.
              - ready_for_pickup: The shipment is ready for pickup at a shipping depot.
              - confirmed: The carrier is aware of the shipment, but hasn't received it yet.
              - in_transit: The shipment is being transported between shipping facilities on the way to its destination.
              - out_for_delivery: The shipment is being delivered to its final destination.
              - delivered: The shipment was succesfully delivered.
              - failure: Something went wrong when pulling tracking information for the shipment, such as the tracking number was invalid or the shipment was canceled.
          - name: status
            description: >
              The status of the fulfillment. Valid values include:
              - pending: Shopify has created the fulfillment and is waiting for the third-party fulfillment service to transition it to 'open' or 'success'.
              - open: The fulfillment has been acknowledged by the service and is in processing.
              - success: The fulfillment was successful.
              - cancelled: The fulfillment was cancelled.
              - error: There was an error with the fulfillment request.
              - failure: The fulfillment request failed.
          - name: tracking_company
            description: The name of the tracking company. 
          - name: tracking_number
            description: Primary tracking number for the order.
          - name: tracking_numbers
            description: A list of tracking numbers, provided by the shipping company.
          - name: tracking_urls
            description: The URLs of tracking pages for the fulfillment.
          - name: updated_at
            description: The date and time (ISO 8601 format) when the fulfillment was last modified.
          
      - name: order_discount_code
        description: Discount codes placed on orders.
        columns:
          - name: _fivetran_synced
            description: "{{ doc('_fivetran_synced') }}"
          - name: amount
            description: The amount that's deducted from the order total.
          - name: code
            description: This property returns the discount code that was entered at checkout. Otherwise this property returns the title of the discount that was applied.
          - name: order_id
            description: Associated order ID.
          - name: type
            description: The type of discount - `fixed_amount`, `percentage`, or `shipping`.