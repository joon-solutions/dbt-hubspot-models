version: 2

models:

  - name: fct__salesforce__combined
    description: This snapshot provides monthly and quarterly metrics that help you understand how your opportunities are performing. Metrics around bookings, the current pipeline and loses are included.
    columns:
      - name: opportunity_id
        description: unique ID of the table
        tests:
          - unique
          - not_null
          - dbt_utils.at_least_one
        meta:
          dimension:
            type: string

      - name: number_of_employees
        description: Number of employees.
        meta:
          dimension:
            type: number

      - name: status
        description: Status (Won, Lost, or Pipeline).
        meta:
          dimension:
            type: string

      - name: opportunity_name
        description: Opportunity Name.
        meta:
          dimension:
            type: string

      - name: account_name
        description: Account Name.
        meta:
          dimension:
            type: string

      - name: forecast_category
        description: Forecast Category.
        meta:
          dimension:
            type: string

      - name: stage_name
        description: Stage Name.
        meta:
          dimension:
            type: string

      - name: created_amount_this_month
        description: The created amount this month.
        meta:
          metrics:
            total_amount_this_month:
              type: sum
      
      - name: created_amount_this_quarter
        description: The created amount this quarter.
        meta:
          metrics:
            total_amount_this_quarter:
              type: sum

      - name: closed_amount_this_month
        description: The closed amount this month.
        meta:
          metrics:
            total_closed_this_quarter:
              type: sum
      
      - name: closed_amount_this_quarter
        description: The closed amount this quarter.
        meta:
          metrics:
            total_closed_this_quarter:
              type: sum
      
      - name: account_type
        description: The account type.
        meta:
          dimension:
            type: string

      - name: created_date
        description: Created date.
        meta:
          dimension:
            type: date
      
      - name: close_date
        description: Closed date.
        meta:
          dimension:
            type: date

      - name: is_won
        description: Is won flag.
        meta:
          metrics:
            total_won:
              type: count
      
      - name: is_closed
        description: Is closed flag. True when the stage name is closed.
        meta:
          metrics:
            total_closed:
              type: count

      - name: opportunity_owner_name
        description: Opportunity Owner name.
        meta:
          dimension:
            type: string
      
      - name: opportunity_manager_name
        description: Opportunity Manager name.
        meta:
          dimension:
            type: string
      
      - name: amount
        description: Amount.
        meta:
          dimension:
            type: number

      - name: days_since_created
        description: Days since created
        meta:
          dimension:
            type: number

      - name: days_to_close
        description: Days to close
        meta:
          dimension:
            type: number



    